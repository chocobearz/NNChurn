---
title: "Churn analysis with logRegression"
author: "Paige, Vicky, and Jackie"
date: '2019-11-10'
output: 
  prettydoc::html_pretty:
  theme : cayman
  highlight : github
  math: katex
---

#This file is our basic logistic regression analysis and our variable assesments


#load clean data
```{r}
library(dplyr)# Load the data
cd <- read.csv(file = "cleanData.csv", header = TRUE, sep = ",", 
                stringsAsFactors = T)

print("ORIGIN DATA")

mutate(cd, customerid = as.character(customerid)) -> cd

summary(cd)
str(cd)
```

```{r}
fit <- glm(churn ~ . -customerid, data = cd, family = "binomial")
summary(fit)
library(ggfortify)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -paymentmethodA -paymentmethodB -tenure3 -tenure4, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```


```{r}
fit <- glm(churn ~ . -customerid -tenure -paymentmethodA -paymentmethodB -tenure4, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -tenure -paymentmethodA -paymentmethodB -tenure3, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -tenure -paymentmethod -paymentmethodB -tenure4, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -tenure -paymentmethod -paymentmethodB -tenure3, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -paymentmethod -paymentmethodB -tenure3 -tenure4, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```


```{r}
fit <- glm(churn ~ . -customerid -tenure -paymentmethodA -tenure3, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -tenure -paymentmethod -paymentmethodA -tenure3, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

```{r}
fit <- glm(churn ~ . -customerid -paymentmethod -paymentmethodA -tenure3 -tenure4, data = cd, family = "binomial")
summary(fit)
autoplot(fit)
```

#We need something better for this
```{r}
library(ggplot2)

ggplot(cd, aes(x = gender, y = churn)) + geom_point()

ggplot(cd, aes(x = seniorcitizen, y = churn)) + geom_point()

ggplot(cd, aes(x = dependents, y = churn)) + geom_point()

ggplot(cd, aes(x = partner, y = churn)) + geom_point()

ggplot(cd, aes(x = tenure, y = churn)) + geom_point()

ggplot(cd, aes(x = phoneservice, y = churn)) + geom_point()

ggplot(cd, aes(x = multiplelines, y = churn)) + geom_point()

ggplot(cd, aes(x = internetservice, y = churn)) + geom_point()

ggplot(cd, aes(x = onlinebackup, y = churn)) + geom_point()

ggplot(cd, aes(x = onlinesecurity, y = churn)) + geom_point()

ggplot(cd, aes(x = deviceprotection, y = churn)) + geom_point()

ggplot(cd, aes(x = techsupport, y = churn)) + geom_point()

ggplot(cd, aes(x = streamingtv, y = churn)) + geom_point()

ggplot(cd, aes(x = streamingmovies, y = churn)) + geom_point()

ggplot(cd, aes(x = contract, y = churn)) + geom_point()

ggplot(cd, aes(x = paperlessbilling, y = churn)) + geom_point()

ggplot(cd, aes(x = monthlycharges, y = churn)) + geom_point()

ggplot(cd, aes(x = totalcharges, y = churn)) + geom_point()

ggplot(cd, aes(x = paymentmethod, y = churn)) + geom_point()

ggplot(cd, aes(x = paymentmethodA, y = churn)) + geom_point()

ggplot(cd, aes(x = paymentmethodB, y = churn)) + geom_point()

ggplot(cd, aes(x = tenure4, y = churn)) + geom_point()

ggplot(cd, aes(x = tenure3, y = churn)) + geom_point()

```

